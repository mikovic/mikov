/*!
* jQuery Text Counter Plugin v0.1.0
* https://github.com/ractoon/jQuery-Text-Counter
*
* Copyright 2013 ractoon
* Released under the MIT license
*/
(function(e){e.textcounter=function(t,n){var r=this;r.$el=e(t);r.el=t;r.$el.data("textcounter",r);r.init=function(){r.options=e.extend({},e.textcounter.defaultOptions,n);var t=r.$el.attr("id")+"-textcount",i=r.options.countDown?r.options.countDownText:r.options.counterText,s=r.options.countDown?r.options.max:0;r.$el.after("<"+r.options.countContainerElement+' class="'+r.options.countContainerClass+'">'+i+'<span class="text-count">'+s+"</span></"+r.options.countContainerElement+">");r.$el.bind("keyup.textcounter click.textcounter blur.textcounter focus.textcounter change.textcounter paste.textcounter",r.checkLimits).trigger("click.textcounter")};r.checkLimits=function(e){var t=r.$el,n=t.siblings("."+r.options.countContainerClass),i=t.val(),s=0,o=0,u=e.originalEvent===undefined?false:true;if(r.options.type=="word"){s=i.replace(/\s+/g," ").split(" ").length;if(t.val()===""){s=0}}else{if(r.options.countSpaces){s=i.length}else{s=i.replace(/\s/g,"").length}}o=r.options.countDown?r.options.max-s:s;r.setCount(o);if(r.options.min>0&&u){if(s<r.options.min){r.setErrors("min")}else if(s>=r.options.min){r.clearErrors("min")}}if(r.options.max!==-1){if(s>r.options.max&&r.options.max!=0){if(r.options.stopInputAtMaximum){var a="";if(r.options.type=="word"){var f=i.split(/[\s\.\?]+/);for(var l=0;l<r.options.max;l++){a+=f[l]+" "}}else{if(r.options.countSpaces){a=i.substring(0,r.options.max)}else{var c=i.split(""),h=c.length,p=0,l=0;while(p<r.options.max&&l<h){if(c[l]!==" ")p++;a+=c[l++]}}}t.val(a);o=r.options.countDown?0:r.options.max;r.setCount(o)}else{r.setErrors("max")}}else{r.clearErrors("max")}}};r.setCount=function(e){var t=r.$el,n=t.siblings("."+r.options.countContainerClass);n.children(".text-count").text(e)};r.setErrors=function(e){var t=r.$el,n=t.siblings("."+r.options.countContainerClass);t.addClass(r.options.inputErrorClass);n.addClass(r.options.counterErrorClass);if(r.options.displayErrorText){switch(e){case"min":errorText=r.options.minimumErrorText;break;case"max":errorText=r.options.maximumErrorText;break}if(!n.children(".error-text-"+e).length){n.append("<"+r.options.errorTextElement+' class="error-text error-text-'+e+'">'+errorText+"</"+r.options.errorTextElement+">")}}};r.clearErrors=function(e){var t=r.$el,n=t.siblings("."+r.options.countContainerClass);n.children(".error-text-"+e).remove();if(n.children(".error-text").length==0){t.removeClass(r.options.inputErrorClass);n.removeClass(r.options.counterErrorClass)}};r.init()};e.textcounter.defaultOptions={type:"character",min:0,max:200,countContainerElement:"div",countContainerClass:"text-count-wrapper",inputErrorClass:"error",counterErrorClass:"error",counterText:"Total Count: ",errorTextElement:"div",minimumErrorText:"Minimum not met",maximumErrorText:"Maximum exceeded",displayErrorText:true,stopInputAtMaximum:true,countSpaces:false,countDown:false,countDownText:"Remaining: "};e.fn.textcounter=function(t){return this.each(function(){new e.textcounter(this,t)})}})(jQuery)